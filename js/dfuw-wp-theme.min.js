/*! dfuw-wp-theme 23-08-2014 */
function CustomMapType(){}function map_initialize(){var a={minZoom:3,maxZoom:7,isPng:!0,mapTypeControl:!1,streetViewControl:!1,center:new google.maps.LatLng(73,-109),zoom:4,mapTypeControlOptions:{mapTypeIds:["custom",google.maps.MapTypeId.ROADMAP],style:google.maps.MapTypeControlStyle.DROPDOWN_MENU}};map=new google.maps.Map(document.getElementById("map_canvas"),a),map.mapTypes.set("custom",CustomMapType),map.setMapTypeId("custom"),google.maps.event.addListener(map,"click",function(a){placeMarker(a.latLng)}),infowindow=new google.maps.InfoWindow({content:"loading..."}),getPOIs()}function getUserLoc(a){var b=a.split("%7C"),c=new google.maps.LatLng(b[0],b[1]);placeMarker(c),map&&(map.setZoom(7),map.setCenter(c))}function placeMarker(a){marker?(marker.setPosition(a),marker.title="Click Me!"):(marker=new google.maps.Marker({position:a,map:map,icon:templateDir+"/images/poi-default.png",title:"Click Me!"}),google.maps.event.addListener(marker,"click",function(){copyToClipboard(this)})),window.location.hash=marker.getPosition().lat()+"%7C"+marker.getPosition().lng()}function copyToClipboard(a){window.prompt("Copy to clipboard: Ctrl+C, Enter","http://darkfallunholywars.info/world-map/#"+a.getPosition().lat()+"%7C"+a.getPosition().lng())}function getPOIs(){mobs.length||(jQuery.ajax({url:templateDir+"/getPOIs.php",dataType:"json",success:function(a){poiArray=a.pois,createMarkers()},error:function(){alert("Problem with Map. Please contact us through the feedback form describing what happened! Thanks!")}}),""!==userPOI&&getUserLoc(userPOI))}function searchPOIs(a){if(a.length<3)return void alert("Please enter atleast 3 characters to perform search.");for(var b=0;b<searchResults.length;b++)searchResults[b].setMap(null);searchArray=[];for(var c=0;c<poiArray.length;c++)if(null==poiArray[c].title);else{var d=poiArray[c].title.toLowerCase().match(a.toLowerCase());null!=d&&searchArray.push(poiArray[c])}showSearchResults(searchArray)}function showSearchResults(a){if(console.log("showing results"),searchResults=[],0===a.length)return void alert("No Results Found. :(");for(var b=0;b<a.length;b++){var c=a[b]._poi_loc.split("|"),d=new google.maps.LatLng(c[0],c[1]),e=a[b].title;e=e.split(" | ");for(var f="<ul>",g=0;g<e.length;g++)f=f+"<li>"+e[g]+"</li>";f+="</ul>";var h=new google.maps.Marker({position:d,map:map,animation:google.maps.Animation.DROP,icon:templateDir+"/images/poi-pink.png",html:f});google.maps.event.addListener(h,"click",function(){copyToClipboard(this)}),google.maps.event.addListener(h,"mouseover",function(){infowindow.setContent(this.html),infowindow.open(map,this)}),searchResults.push(h)}for(var i=new google.maps.LatLngBounds,j=0;j<searchResults.length;j++)searchResults[j].setMap(map),i.extend(searchResults[b].getPosition()),map.fitBounds(i)}function createMarkers(){for(var a,b=null,c=0;c<poiArray.length;c++){switch(poiArray[c]._poi_type){case"bank":a=templateDir+"/images/poi-bank.png",b=banks;break;case"mob":a=""===poiArray[c]._poi_level?templateDir+"/images/poi-mob.png":templateDir+"/images/poi-mob-"+poiArray[c]._poi_level+".png",b=mobs;break;case"city":a=templateDir+"/images/poi-city.png",b=holdings;break;case"hamlet":a=templateDir+"/images/poi-hamlet.png",b=holdings;break;case"cbind":a=templateDir+"/images/poi-bind-chaos.png",b=binds;break;case"sbind":a=templateDir+"/images/poi-bind-safe.png",b=binds;break;case"craft":a=templateDir+"/images/poi-craft.png",b=crafts;break;case"portal":a=templateDir+"/images/poi-portal.png",b=portals;break;case"pchamber":a=templateDir+"/images/poi-chamber.png",b=portals;break;case"village":a=templateDir+"/images/poi-village.png",b=villages;break;case"chest":a=templateDir+"/images/poi-chest.png",b=chests}var d=poiArray[c]._poi_loc.split("|"),e=poiArray[c].title;null!=e&&e.match("|")&&(e=e.split("|"));var f="<ul>";if(null!=e&&e.length>0)for(var g=0;g<e.length;g++)f=f+"<li>"+e[g]+"</li>";else f=f+"<li>"+e+"</li>";f+="</ul>";var h=new google.maps.LatLng(d[0],d[1]),i=new google.maps.Marker({position:h,map:null,icon:a,html:f});google.maps.event.addListener(i,"click",function(){copyToClipboard(this)}),google.maps.event.addListener(i,"mouseover",function(){infowindow.setContent(this.html),infowindow.open(map,this)}),b.push(i)}}function showMarkers(a){var b;switch(a){case"mobs":b=mobs;break;case"banks":b=banks;break;case"crafts":b=crafts;break;case"binds":b=binds;break;case"portals":b=portals;break;case"holdings":b=holdings;break;case"villages":b=villages;break;case"chests":b=chests}for(var c=new google.maps.LatLngBounds,d=0;d<b.length;d++)b[d].setMap(map),c.extend(b[d].getPosition()),map.fitBounds(c)}function hideMarkers(a){var b;switch(a){case"mobs":b=mobs;break;case"banks":b=banks;break;case"crafts":b=crafts;break;case"binds":b=binds;break;case"portals":b=portals;break;case"holdings":b=holdings;break;case"villages":b=villages;break;case"chests":b=chests}for(var c=0;c<b.length;c++)b[c].setMap(null)}function checkToggles(){jQuery.each(jQuery("#map-legend a"),function(){if(jQuery(this).hasClass("active"))switch(jQuery(this).attr("id")){case"mob-btn":showMarkers("mobs");break;case"bank-btn":showMarkers("banks");break;case"craft-btn":showMarkers("crafts");break;case"bind-btn":showMarkers("binds");break;case"portal-btn":showMarkers("portals");break;case"holding-btn":showMarkers("holdings");break;case"village-btn":showMarkers("villages");break;case"chest-btn":showMarkers("chests")}})}CustomMapType.prototype.tileSize=new google.maps.Size(256,256),CustomMapType.prototype.maxZoom=7,CustomMapType.prototype.getTile=function(a,b,c){var d=c.createElement("DIV"),e=templateDir+"/images/tiles/";return e+=b+"_"+a.x+"_"+a.y+".png",d.style.width=this.tileSize.width+"px",d.style.height=this.tileSize.height+"px",d.style.backgroundColor="#00000",d.style.backgroundImage="url("+e+")",d},CustomMapType.prototype.name="Custom",CustomMapType.prototype.alt="Tile Coordinate Map Type";var map,CustomMapType=new CustomMapType,fullscreen=!1,showMobs=!1,showBanks=!1,showCrafts=!1,showBinds=!1,showPortals=!1,showChests=!1,showHoldings=!1,showVillages=!1,mobs=[],banks=[],binds=[],crafts=[],portals=[],chambers=[],chests=[],holdings=[],villages=[],searchArray=[],searchResults=[],infowindow=null,marker,poiArray;!function(a){function b(a){var b=new RegExp(j.join("|"),"gi");return a.replace(b,"****")}a.browser.msie?a("html").addClass("msie"):a.browser.mozilla?a("html").addClass("mozilla"):a.browser.chrome&&a("html").addClass("chrome"),a(".accordion").length&&a(".accordion").accordion({collapsible:!0}),a("#expand-all").length&&a("#expand-all").click(function(){"Expand All"==a("#expand-all span").text()?(a(".accordion .pane").show(),a("#expand-all span").text("Collapse All"),a("#expand-all i").removeClass("icon-plus-sign").addClass("icon-minus-sign")):(a(".accordion-header").removeClass("current"),a("#expand-all span").text("Expand All"),a("#expand-all i").removeClass("icon-minus-sign").addClass("icon-plus-sign"),a(".accordion").accordion("destroy").accordion({collapsible:!0}))}),a("#expand-all").length&&a(".accordion-header").click(function(){a(this);a("#expand-all i").hasClass("icon-minus-sign")&&(a("#expand-all span").text("Expand All"),a("#expand-all i").removeClass("icon-minus-sign").addClass("icon-plus-sign"),a(".accordion").accordion("destroy").accordion({collapsible:!0}))});var c={init:function(){a("#school_selector").change(function(){window.location=a(this).val()}),a("#content.air").length&&a(".excl-legend span").text("Earth"),a("#content.earth").length&&a(".excl-legend span").text("Air"),a("#content.pain").length&&a(".excl-legend span").text("Life"),a("#content.life").length&&a(".excl-legend span").text("Pain"),a("#content.law").length&&a(".excl-legend span").text("Chaos"),a("#content.chaos").length&&a(".excl-legend span").text("Law"),a("#content.brawler").length&&a(".excl-legend span").text("Blackguard"),a("#content.blackguard").length&&a(".excl-legend span").text("Brawler"),a("#content.deadeye").length&&a(".excl-legend span").text("Duelist"),a("#content.duelist").length&&a(".excl-legend span").text("Deadeye"),a("#content.baresark").length&&a(".excl-legend span").text("Champion"),a("#content.champion").length&&a(".excl-legend span").text("Baresark"),a("#content.battle-brand").length&&a(".excl-legend span").text("Slayer"),a("#content.slayer").length&&a(".excl-legend span").text("Battle Brand"),a("#content.fire").length&&a(".excl-legend span").text("Water"),a("#content.water").length&&a(".excl-legend span").text("Fire")}},d={init:function(){a("#clans-list").tablesorter({widgets:["zebra"]}),a("#server_select").change(function(){window.location="../"+a(this).val()})}},e={init:function(){e.twitchLiveStreams(),a("#df-vid").attr("src","http://www.youtube.com/embed/"+a("#featured-list li:first-child a").data("vidId")+"?rel=0&autoplay=0&iv_load_policy=3&modestbranding=1&wmode=opaque"),a("#featured-list li a").on({click:function(){var b=a(this).data("vidId");a("#df-vid").attr("src","http://www.youtube.com/embed/"+b+"?rel=0&autoplay=1&iv_load_policy=3&modestbranding=1&wmode=opaque"),a("#twitch-player").hide()}}),e.getForumFallFeed(),a(".blogfeed a.post").ellipsis()},showTwitchChannel:function(b){var c=b.streams[0].channel.display_name;a(".entry-content").prepend('<object id="twitch-player" type="application/x-shockwave-flash" height="371" width="659" id="live_embed_player_flash" data="http://www.twitch.tv/widgets/live_embed_player.swf?channel='+c+'" bgcolor="#000000"><param name="allowFullScreen" value="true" /><param name="allowScriptAccess" value="always" /><param name="allowNetworking" value="false" /><param name="movie" value="http://www.twitch.tv/widgets/live_embed_player.swf" /><param name="flashvars" value="hostname=www.twitch.tv&channel='+c+'&auto_play=true&start_volume=25" /></object>');var d=a("#twitch-live").html();d=d.replace("{NAME}",c.toUpperCase()),a("#twitch-live").data("streamer",c).html(d).show(),a("#twitch-live").click(function(){return a("#twitch-player").show(),a("#df-vid").attr("src",""),!1})},twitchLiveStreams:function(){Twitch.init({clientId:"207ndj3uuk5rmh6sdazihsx8aw53mm4"},function(){Twitch.api({method:"streams",params:{game:"Darkfall Unholy Wars",limit:3}},function(a,b){b.streams.length>0&&(window.dfuwTwitchList=b,e.showTwitchChannel(b))})})},getForumFallFeed:function(){a(".load-wrapper").stop(!0,!0).fadeIn("fast"),a.ajax({url:templateDir+"/proxy.php?url=http://forums.darkfallonline.com/external.php?type=RSS2",dataType:"xml",async:!1,type:"GET",timeout:6e4,success:function(c){var d="<ul>";a(c).find("item").each(function(c){return c>4?!1:void(d+='<li><a href="'+a(this).find("link").text()+'" target="_blank" rel="nofollow"><span class="title">'+b(a(this).find("title").text())+'</span></a> <div class="descr">'+b(a(this).find("description").text())+"</div></li>")}),d+="</ul>",a(".bottom .forumfeed ul").length&&a(".bottom .forumfeed ul").remove(),"<ul></ul>"==d?(d="<ul><li><strong>Forums currently offline!</strong></li></ul>",a(".bottom .forumfeed").append(d)):(a(".bottom .forumfeed").append(d),a(".forumfeed li a, .forumfeed li .descr").ellipsis()),a(".load-wrapper").stop(!0,!0).fadeOut(),setTimeout(function(){e.getForumFallFeed()},18e4)},error:function(){a(".loading, .loader").stop(!0,!0).fadeOut(),setTimeout(function(){e.getForumFallFeed()},18e4)}})}},f={getStatus:function(){a.ajax({url:templateDir+"/serverstatus.php",dataType:"json",timeout:6e4,success:function(b){if("SUCCESS"==b["@attributes"].Result){a("#server-status").find("span i").removeClass("up down");for(var c=b.Servers.ServerStatus,d=0;d<c.length;d++){var e=c[d]["@attributes"].ID.toLowerCase();a("#server-status").find("."+e).find("i").addClass(c[d]["@attributes"].Status.toLowerCase())}}},error:function(){a("#server-status").find("span i").removeClass("up down")}}),setTimeout(function(){f.getStatus()},12e4)}},g={init:function(){a(".your-subject").change(function(){"Add My Clan"==a(".your-subject option:selected").val()?(a(".feedback .clan-details").slideDown(),a(".feedback .event-details").slideUp()):"Add My Event"==a(".your-subject option:selected").val()?(a(".feedback .clan-details").slideUp(),a(".feedback .event-details").slideDown()):(a(".feedback .clan-details").slideUp(),a(".feedback .event-details").slideUp())})}},h={init:function(){a("#fs-btn").click(function(){fullscreen?(a("#map-container").appendTo(".entry-content"),a("#fs-btn").removeClass("active"),fullscreen=!1,map_initialize(),checkToggles(),marker&&marker.setMap(map)):(a("#map-container").appendTo("body"),a("#fs-btn").addClass("active"),a("body").scrollTop(0),fullscreen=!0,map_initialize(),checkToggles(),marker&&marker.setMap(map))}),a("#mob-btn").click(function(){showMobs?(a("#mob-btn").removeClass("active"),showMobs=!1,hideMarkers("mobs")):(a("#mob-btn").addClass("active"),showMobs=!0,showMarkers("mobs"))}),a("#bank-btn").click(function(){showBanks?(a("#bank-btn").removeClass("active"),showBanks=!1,hideMarkers("banks")):(a("#bank-btn").addClass("active"),showBanks=!0,showMarkers("banks"))}),a("#chest-btn").click(function(){showBanks?(a("#chest-btn").removeClass("active"),showBanks=!1,hideMarkers("chests")):(a("#chest-btn").addClass("active"),showBanks=!0,showMarkers("chests"))}),a("#craft-btn").click(function(){showCrafts?(a("#craft-btn").removeClass("active"),showCrafts=!1,hideMarkers("crafts")):(a("#craft-btn").addClass("active"),showCrafts=!0,showMarkers("crafts"))}),a("#bind-btn").click(function(){showBinds?(a("#bind-btn").removeClass("active"),showBinds=!1,hideMarkers("binds")):(a("#bind-btn").addClass("active"),showBinds=!0,showMarkers("binds"))}),a("#portal-btn").click(function(){showPortals?(a("#portal-btn").removeClass("active"),showPortals=!1,hideMarkers("portals")):(a("#portal-btn").addClass("active"),showPortals=!0,showMarkers("portals"))}),a("#holding-btn").click(function(){showHoldings?(a("#holding-btn").removeClass("active"),showHoldings=!1,hideMarkers("holdings")):(a("#holding-btn").addClass("active"),showHoldings=!0,showMarkers("holdings"))}),a("#village-btn").click(function(){showVillages?(a("#village-btn").removeClass("active"),showVillages=!1,hideMarkers("villages")):(a("#village-btn").addClass("active"),showVillages=!0,showMarkers("villages"))}),a("#searchmap").click(function(){searchPOIs(a("#mapsearch-text").val())}),a("#mapsearch-text").keypress(function(b){13==b.which&&searchPOIs(a("#mapsearch-text").val())})}},i={init:function(){a(".video h2, .video p").ellipsis()}},j=["fuck","shit","fag"," ass","puss","nigg","bitch","asshole","dick","penis","vagina","cunt"];a(".post-type-archive-role, .post-type-archive-school, .post-type-archive-spell, .single-school").length&&c.init(),a(".page-template-archive-video-php").length&&i.init(),a("h2").length&&a("h2").ellipsis(),a(".home").length&&e.init(),a(".clans").length&&d.init(),a(".feedback").length&&g.init(),a("#branding").length&&f.getStatus(),a("#map_canvas").length&&(map_initialize(),h.init()),a(".misc-game-info").length&&a("table").tablesorter({widgets:["zebra"]}),a(".gad").each(function(){0===a(this).height()&&(a(this).addClass("blocked"),"long"==a(this).data("adType")?a(this).html('<a href="http://www.gamefanshop.com/partner-IamRedSeal/" target="_blank"><img src="http://www.gamefanshop.com/StoreFiles/Styles/vip/banner1.jpg" alt="gamefanshop partner banner" /></a>'):"square"==a(this).data("adType")&&a(this).html('<a href="http://www.gamefanshop.com/partner-IamRedSeal/" target="_blank"><img src="http://www.gamefanshop.com/StoreFiles/Styles/vip/banner2t.jpg" width="180" alt="gamefanshop partner banner" /></a>'))})}(jQuery),function(a){window.crafter={skill:"",advanced:!1,mastery:!1,masteryList:[],allItems:[],firstDrop:[],secDrop:[],filteredList:[],item:{},itemCount:1,style:"militant",getData:function(b){switch(crafter.reset(),crafter.skill=a("#trade_select").val(),b){case"weaponsmithing":crafter.advanced=!0;break;default:crafter.advanced=!1}a.ajax({url:templateDir+"/data/crafting_recipes_"+b+".json",dataType:"json"}).success(function(a){if(crafter.allItems=a,crafter.mastery)for(var b=0;b<crafter.allItems.length;b++)crafter.allItems[b].Skill.match("Mastery")&&crafter.masteryList.push(crafter.allItems[b])},function(){crafter.createList(crafter.firstDrop,crafter.allItems)}).error(function(){alert("Error Loading Items: ",arguments)})},createList:function(b,c){c=crafter.mastery?crafter.masteryList:c;for(var d=0;d<c.length;d++)if(crafter.advanced){var e=c[d].Name.split(" "),f=e[e.length-1];-1===a.inArray(f,b)&&b.push(f)}else-1===a.inArray(c[d].Name,b)&&b.push(c[d].Name);b.sort(),crafter.appendList(b,a("#select-two"))},appendList:function(a,b){for(var c="",d=0;d<a.length;d++)c=c+'<option value="'+a[d].toLowerCase()+'">'+a[d]+"</option>";b.html(c),b.parent().fadeIn().find("input").focus()},reset:function(){crafter.skill="",crafter.advanced=!1,crafter.masteryList=[],crafter.allItems=[],crafter.firstDrop=[],crafter.secDrop=[],crafter.filteredList=[],a("#select-three").parent().hide(),a("#item-details .template").fadeOut("",function(){a(this).remove()})},filterList:function(){crafter.filteredList=[],crafter.secDrop=[];for(var b=crafter.mastery?crafter.masteryList:crafter.allItems,c=new RegExp("\\b"+a("#select-two").val(),"gi"),d=0;d<b.length;d++){if(b[d].Name.match(c)){var e=b[d].Name.split(" "),f=e[0];-1===a.inArray(f,crafter.secDrop)&&crafter.secDrop.push(f),crafter.filteredList.push(b[d])}crafter.secDrop.sort(),crafter.appendList(crafter.secDrop,a("#select-three"))}},showItem:function(b){crafter.item=b;var c=a("#item-template").clone().attr("id",b.id).fadeIn("slow");c.find("#thumb").append('<img src="'+templateDir+"/data/icons/"+b.Icon+'" width="64" height="64"/>');var d='<h3><span class="theName">'+b.Name+"</span></h3><p>";d=d+"<strong>Skill:</strong> "+b.Skill+"<br>",d=d+"<strong>Min Level:</strong> "+b["Min Level"]+"<br>",d=d+"<strong>Max Level:</strong> "+b["Max Level"]+"<br>",d=d+"<strong>Quantity:</strong> "+b.Quantity+"<br>",d+='<ul class="ingredients">';for(var e in b.Recipe)d=d+"<li><strong>"+e+":</strong> "+b.Recipe[e]+"</li>";d+="</ul></p>",c.find(".ingredients .details").html(d),c.find(".recipe .well").html(crafter.calculate(b)),c.find("#item-count").val(crafter.itemCount),a("#item-details").removeClass().addClass(b.Skill.toLowerCase()).html(c),crafter.changeStyle()},calculate:function(b){var c=b.Name,d=a("#item-count").val(),e="<strong>"+b.Quantity*crafter.itemCount+'</strong> <span class="theName"> '+c+"</span>: ";for(var f in crafter.item.Recipe)e=e+d*crafter.item.Recipe[f]+" "+f,Object.keys(crafter.item.Recipe)[Object.keys(crafter.item.Recipe).length-1]!=f&&(e+=", ");return e},changeStyle:function(){for(var b=a(".theName:first").text(),c=b.split(" "),d=0;d<c.length;d++)("militant"==c[d].toLowerCase()||"stoic"==c[d].toLowerCase()||"barbaric"==c[d].toLowerCase())&&(c[d]=crafter.style);var e=c.join(" ");a(".theName").text(e);var f=a("#item-details").find("#thumb img").attr("src");f=f.replace("militant",crafter.style).replace("barbaric",crafter.style).replace("stoic",crafter.style),a("#item-details").find("#thumb img").attr("src",f),a("#item-details .btn-group .btn").removeClass("active"),a('#item-details .btn[data-style="'+crafter.style+'"]').addClass("active")}},a("#trade_select").change(function(){crafter.getData(a(this).val())}),a("#select-two").change(function(){if(crafter.advanced)crafter.filterList(a(this).find("option:selected").val());else for(var b=new RegExp("\\b"+a("#select-two").val(),"gi"),c=0;c<crafter.allItems.length;c++)crafter.allItems[c].Name.match(b)&&crafter.showItem(crafter.allItems[c])}),a("#select-three").change(function(){var b=new RegExp(a("#select-three").val()+"\\s(.*)\\s?\\b"+a("#select-two").val(),"gi");a("#select-three").val()===a("#select-two").val()&&(b=new RegExp("^"+a("#select-three").val()+"$","i"));for(var c=0;c<crafter.filteredList.length;c++)crafter.filteredList[c].Name.match(b)&&crafter.showItem(crafter.filteredList[c])}),a("#mastery").change(function(){crafter.mastery="checked"==a(this).attr("checked")?!0:!1,""!==a("#trade_select").val()&&crafter.getData(a("#trade_select").val())}),a("#item-count").live("change",function(){crafter.itemCount=a(this).val(),a("#item-details .recipe .well").html(crafter.calculate(crafter.item)),crafter.changeStyle()}),a(".btn.styleSwitch").live("click",function(){crafter.style=a(this).data("style"),crafter.changeStyle()}),a(".recipe .well").live("click",function(){window.prompt("Copy Recipe",a(this).text())})}(jQuery),Array.prototype.inArray=function(a){for(var b=0;b<this.length;b++)if(a(this[b]))return!0;return!1},Array.prototype.pushIfNotExist=function(a,b){this.inArray(b)||this.push(a)},function(a){a.widget("custom.combobox",{_create:function(){this.wrapper=a("<span>").addClass("custom-combobox").insertAfter(this.element),this.element.hide(),this._createAutocomplete(),this._createShowAllButton()},_createAutocomplete:function(){var b=this.element.children(":selected"),c=b.val()?b.text():"";this.input=a("<input>").appendTo(this.wrapper).val(c).attr("title","").addClass("custom-combobox-input ui-widget ui-widget-content ui-state-default ui-corner-left").autocomplete({delay:0,minLength:0,source:a.proxy(this,"_source")}).tooltip({tooltipClass:"ui-state-highlight"}),this._on(this.input,{autocompleteselect:function(a,b){b.item.option.selected=!0,this._trigger("select",a,{item:b.item.option})},autocompletechange:"_removeIfInvalid"})},_createShowAllButton:function(){var b=this.input,c=!1;a("<div>").attr("tabIndex",-1).attr("title","Show All Items").appendTo(this.wrapper).button({icons:{primary:"ui-icon-triangle-1-s"},text:!1}).removeClass("ui-corner-all").addClass("custom-combobox-toggle ui-corner-right").mousedown(function(){c=b.autocomplete("widget").is(":visible")}).click(function(){b.focus(),c||b.autocomplete("search","")})},_source:function(b,c){var d=new RegExp(a.ui.autocomplete.escapeRegex(b.term),"i");c(this.element.children("option").map(function(){var c=a(this).text();return!this.value||b.term&&!d.test(c)?void 0:{label:c,value:c,option:this}}))},_removeIfInvalid:function(b,c){if(!c.item){var d=this.input.val(),e=d.toLowerCase(),f=!1;this.element.children("option").each(function(){return a(this).text().toLowerCase()===e?(this.selected=f=!0,!1):void 0}),f||(this.input.val("").attr("title",d+" didn't match any item").tooltip("open"),this.element.val(""),this._delay(function(){this.input.tooltip("close").attr("title","")},2500),this.input.autocomplete("instance").term="")}},_destroy:function(){this.wrapper.remove(),this.element.show()}})}(jQuery),function(a){a("#trade_select").combobox({select:function(){crafter.getData(this.value),a(".selection-box:first").find("input").val("").focus()}}),a("#select-two").combobox({select:function(){if(crafter.advanced)crafter.filterList(this.value);else for(var b=new RegExp("^\\b"+RegExp.escape(this.value),"gi"),c=0;c<crafter.allItems.length;c++)crafter.allItems[c].Name.match(b)&&crafter.showItem(crafter.allItems[c]);a(".selection-box:last").find("input").val("").focus()}}),a("#select-three").combobox({select:function(){var b=new RegExp(this.value+"\\s(.*)\\s?\\b"+a("#select-two").val(),"gi");this.value===a("#select-two").val()&&(b=new RegExp("^"+this.value+"$","i"));for(var c=0;c<crafter.filteredList.length;c++)crafter.filteredList[c].Name.match(b)&&crafter.showItem(crafter.filteredList[c])}})}(jQuery),RegExp.escape=function(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},function(a){function b(){if(!l){l=!0;for(var b in k)a(b).each(function(){var c,d;c=a(this),d=c.data("jqae"),(d.containerWidth!=c.width()||d.containerHeight!=c.height())&&i(c,k[b])});l=!1}}function c(a){k[a]&&(delete k[a],k.length||j&&(window.clearInterval(j),j=void 0))}function d(a,c){k[a]=c,j||(j=window.setInterval(function(){b()},200))}function e(){return 3===this.nodeType}function f(b){if(b.contents().length){var c=b.contents(),d=c.eq(c.length-1);if(d.filter(e).length){var g=d.get(0).nodeValue;return g=a.trim(g),""==g?(d.remove(),!0):!1}for(;f(d););return d.contents().length?!1:(d.remove(),!0)}return!1}function g(a){if(a.contents().length){var b=a.contents(),c=b.eq(b.length-1);return c.filter(e).length?c:g(c)}a.append("");var b=a.contents();return b.eq(b.length-1)}function h(b){var c=g(b);if(c.length){var d=c.get(0).nodeValue,e=d.lastIndexOf(" ");return e>-1?(d=a.trim(d.substring(0,e)),c.get(0).nodeValue=d):c.get(0).nodeValue="",!0}return!1}function i(b,c){var d=b.data("jqae");d||(d={});var e=d.wrapperElement;e||(e=b.wrapInner("<div/>").find(">div"),e.css({margin:0,padding:0,border:0}));var i=e.data("jqae");i||(i={});var j=i.originalContent;j?e=i.originalContent.clone(!0).data("jqae",{originalContent:j}).replaceAll(e):e.data("jqae",{originalContent:e.clone(!0)}),b.data("jqae",{wrapperElement:e,containerWidth:b.width(),containerHeight:b.height()});var k=b.height(),l=(parseInt(b.css("padding-top"),10)||0)+(parseInt(b.css("border-top-width"),10)||0)-(e.offset().top-b.offset().top),m=!1,n=e;c.selector&&(n=a(e.find(c.selector).get().reverse())),n.each(function(){var b=a(this),d=b.text(),i=!1;if(e.innerHeight()-b.innerHeight()>k+l)b.remove();else if(f(b),b.contents().length){for(m&&(g(b).get(0).nodeValue+=c.ellipsis,m=!1);e.innerHeight()>k+l;){if(i=h(b),!i){m=!0,b.remove();break}if(f(b),!b.contents().length){m=!0,b.remove();break}g(b).get(0).nodeValue+=c.ellipsis}"onEllipsis"==c.setTitle&&i||"always"==c.setTitle?b.attr("title",d):"never"!=c.setTitle&&b.removeAttr("title")}})}var j,k={},l=!1,m={ellipsis:"...",setTitle:"never",live:!1};a.fn.ellipsis=function(b,e){var f,g;return f=a(this),"string"!=typeof b&&(e=b,b=void 0),g=a.extend({},m,e),g.selector=b,f.each(function(){var b=a(this);i(b,g)}),g.live?d(f.selector,g):c(f.selector),this}}(jQuery),function($){$.extend({tablesorter:new function(){function benchmark(a,b){log(a+","+((new Date).getTime()-b.getTime())+"ms")}function log(a){"undefined"!=typeof console&&"undefined"!=typeof console.debug?console.log(a):alert(a)}function buildParserCache(a,b){if(a.config.debug)var c="";if(0!=a.tBodies.length){var d=a.tBodies[0].rows;if(d[0])for(var e=[],f=d[0].cells,g=f.length,h=0;g>h;h++){var i=!1;$.metadata&&$(b[h]).metadata()&&$(b[h]).metadata().sorter?i=getParserById($(b[h]).metadata().sorter):a.config.headers[h]&&a.config.headers[h].sorter&&(i=getParserById(a.config.headers[h].sorter)),i||(i=detectParserForColumn(a,d,-1,h)),a.config.debug&&(c+="column:"+h+" parser:"+i.id+"\n"),e.push(i)}return a.config.debug&&log(c),e}}function detectParserForColumn(a,b,c,d){for(var e=parsers.length,f=!1,g=!1,h=!0;""==g&&h;)c++,b[c]?(f=getNodeFromRowAndCellIndex(b,c,d),g=trimAndGetNodeText(a.config,f),a.config.debug&&log("Checking if value was empty on row:"+c)):h=!1;for(var i=1;e>i;i++)if(parsers[i].is(g,a,f))return parsers[i];return parsers[0]}function getNodeFromRowAndCellIndex(a,b,c){return a[b].cells[c]}function trimAndGetNodeText(a,b){return $.trim(getElementText(a,b))}function getParserById(a){for(var b=parsers.length,c=0;b>c;c++)if(parsers[c].id.toLowerCase()==a.toLowerCase())return parsers[c];return!1}function buildCache(a){if(a.config.debug)var b=new Date;for(var c=a.tBodies[0]&&a.tBodies[0].rows.length||0,d=a.tBodies[0].rows[0]&&a.tBodies[0].rows[0].cells.length||0,e=a.config.parsers,f={row:[],normalized:[]},g=0;c>g;++g){var h=$(a.tBodies[0].rows[g]),i=[];if(h.hasClass(a.config.cssChildRow))f.row[f.row.length-1]=f.row[f.row.length-1].add(h);else{f.row.push(h);for(var j=0;d>j;++j)i.push(e[j].format(getElementText(a.config,h[0].cells[j]),a,h[0].cells[j]));i.push(f.normalized.length),f.normalized.push(i),i=null}}return a.config.debug&&benchmark("Building cache for "+c+" rows:",b),f}function getElementText(a,b){var c="";return b?(a.supportsTextContent||(a.supportsTextContent=b.textContent||!1),c="simple"==a.textExtraction?a.supportsTextContent?b.textContent:b.childNodes[0]&&b.childNodes[0].hasChildNodes()?b.childNodes[0].innerHTML:b.innerHTML:"function"==typeof a.textExtraction?a.textExtraction(b):$(b).text()):""}function appendToTable(a,b){if(a.config.debug)var c=new Date;for(var d=b,e=d.row,f=d.normalized,g=f.length,h=f[0].length-1,i=$(a.tBodies[0]),j=[],k=0;g>k;k++){var l=f[k][h];if(j.push(e[l]),!a.config.appender)for(var m=e[l].length,n=0;m>n;n++)i[0].appendChild(e[l][n])}a.config.appender&&a.config.appender(a,j),j=null,a.config.debug&&benchmark("Rebuilt table:",c),applyWidget(a),setTimeout(function(){$(a).trigger("sortEnd")},0)}function buildHeaders(a){if(a.config.debug)var b=new Date;var c=($.metadata?!0:!1,computeTableHeaderCellIndexes(a));return $tableHeaders=$(a.config.selectorHeaders,a).each(function(b){if(this.column=c[this.parentNode.rowIndex+"-"+this.cellIndex],this.order=formatSortingOrder(a.config.sortInitialOrder),this.count=this.order,(checkHeaderMetadata(this)||checkHeaderOptions(a,b))&&(this.sortDisabled=!0),checkHeaderOptionsSortingLocked(a,b)&&(this.order=this.lockedOrder=checkHeaderOptionsSortingLocked(a,b)),!this.sortDisabled){var d=$(this).addClass(a.config.cssHeader);a.config.onRenderHeader&&a.config.onRenderHeader.apply(d)}a.config.headerList[b]=this}),a.config.debug&&(benchmark("Built headers:",b),log($tableHeaders)),$tableHeaders}function computeTableHeaderCellIndexes(a){for(var b=[],c={},d=a.getElementsByTagName("THEAD")[0],e=d.getElementsByTagName("TR"),f=0;f<e.length;f++)for(var g=e[f].cells,h=0;h<g.length;h++){var i,j=g[h],k=j.parentNode.rowIndex,l=k+"-"+j.cellIndex,m=j.rowSpan||1,n=j.colSpan||1;"undefined"==typeof b[k]&&(b[k]=[]);for(var o=0;o<b[k].length+1;o++)if("undefined"==typeof b[k][o]){i=o;break}c[l]=i;for(var o=k;k+m>o;o++){"undefined"==typeof b[o]&&(b[o]=[]);for(var p=b[o],q=i;i+n>q;q++)p[q]="x"}}return c}function checkCellColSpan(a,b,c){for(var d=[],e=a.tHead.rows,f=e[c].cells,g=0;g<f.length;g++){var h=f[g];h.colSpan>1?d=d.concat(checkCellColSpan(a,headerArr,c++)):(1==a.tHead.length||h.rowSpan>1||!e[c+1])&&d.push(h)}return d}function checkHeaderMetadata(a){return $.metadata&&$(a).metadata().sorter===!1?!0:!1}function checkHeaderOptions(a,b){return a.config.headers[b]&&a.config.headers[b].sorter===!1?!0:!1}function checkHeaderOptionsSortingLocked(a,b){return a.config.headers[b]&&a.config.headers[b].lockedOrder?a.config.headers[b].lockedOrder:!1}function applyWidget(a){for(var b=a.config.widgets,c=b.length,d=0;c>d;d++)getWidgetById(b[d]).format(a)}function getWidgetById(a){for(var b=widgets.length,c=0;b>c;c++)if(widgets[c].id.toLowerCase()==a.toLowerCase())return widgets[c]}function formatSortingOrder(a){return"Number"!=typeof a?"desc"==a.toLowerCase()?1:0:1==a?1:0}function isValueInArray(a,b){for(var c=b.length,d=0;c>d;d++)if(b[d][0]==a)return!0;return!1}function setHeadersCss(a,b,c,d){b.removeClass(d[0]).removeClass(d[1]);var e=[];b.each(function(){this.sortDisabled||(e[this.column]=$(this))});for(var f=c.length,g=0;f>g;g++)e[c[g][0]].addClass(d[c[g][1]])}function fixColumnWidth(a){var b=a.config;if(b.widthFixed){var c=$("<colgroup>");$("tr:first td",a.tBodies[0]).each(function(){c.append($("<col>").css("width",$(this).width()))}),$(a).prepend(c)}}function updateHeaderSortCount(a,b){for(var c=a.config,d=b.length,e=0;d>e;e++){var f=b[e],g=c.headerList[f[0]];g.count=f[1],g.count++}}function multisort(table,sortList,cache){if(table.config.debug)var sortTime=new Date;for(var dynamicExp="var sortWrapper = function(a,b) {",l=sortList.length,i=0;l>i;i++){var c=sortList[i][0],order=sortList[i][1],s="text"==table.config.parsers[c].type?0==order?makeSortFunction("text","asc",c):makeSortFunction("text","desc",c):0==order?makeSortFunction("numeric","asc",c):makeSortFunction("numeric","desc",c),e="e"+i;dynamicExp+="var "+e+" = "+s,dynamicExp+="if("+e+") { return "+e+"; } ",dynamicExp+="else { "}var orgOrderCol=cache.normalized[0].length-1;dynamicExp+="return a["+orgOrderCol+"]-b["+orgOrderCol+"];";for(var i=0;l>i;i++)dynamicExp+="}; ";return dynamicExp+="return 0; ",dynamicExp+="}; ",table.config.debug&&benchmark("Evaling expression:"+dynamicExp,new Date),eval(dynamicExp),cache.normalized.sort(sortWrapper),table.config.debug&&benchmark("Sorting on "+sortList.toString()+" and dir "+order+" time:",sortTime),cache}function makeSortFunction(a,b,c){var d="a["+c+"]",e="b["+c+"]";
return"text"==a&&"asc"==b?"("+d+" == "+e+" ? 0 : ("+d+" === null ? Number.POSITIVE_INFINITY : ("+e+" === null ? Number.NEGATIVE_INFINITY : ("+d+" < "+e+") ? -1 : 1 )));":"text"==a&&"desc"==b?"("+d+" == "+e+" ? 0 : ("+d+" === null ? Number.POSITIVE_INFINITY : ("+e+" === null ? Number.NEGATIVE_INFINITY : ("+e+" < "+d+") ? -1 : 1 )));":"numeric"==a&&"asc"==b?"("+d+" === null && "+e+" === null) ? 0 :("+d+" === null ? Number.POSITIVE_INFINITY : ("+e+" === null ? Number.NEGATIVE_INFINITY : "+d+" - "+e+"));":"numeric"==a&&"desc"==b?"("+d+" === null && "+e+" === null) ? 0 :("+d+" === null ? Number.POSITIVE_INFINITY : ("+e+" === null ? Number.NEGATIVE_INFINITY : "+e+" - "+d+"));":void 0}function makeSortText(a){return"((a["+a+"] < b["+a+"]) ? -1 : ((a["+a+"] > b["+a+"]) ? 1 : 0));"}function makeSortTextDesc(a){return"((b["+a+"] < a["+a+"]) ? -1 : ((b["+a+"] > a["+a+"]) ? 1 : 0));"}function makeSortNumeric(a){return"a["+a+"]-b["+a+"];"}function makeSortNumericDesc(a){return"b["+a+"]-a["+a+"];"}function sortText(a,b){return table.config.sortLocaleCompare?a.localeCompare(b):b>a?-1:a>b?1:0}function sortTextDesc(a,b){return table.config.sortLocaleCompare?b.localeCompare(a):a>b?-1:b>a?1:0}function sortNumeric(a,b){return a-b}function sortNumericDesc(a,b){return b-a}function getCachedSortType(a,b){return a[b].type}var parsers=[],widgets=[];this.defaults={cssHeader:"header",cssAsc:"headerSortUp",cssDesc:"headerSortDown",cssChildRow:"expand-child",sortInitialOrder:"asc",sortMultiSortKey:"shiftKey",sortForce:null,sortAppend:null,sortLocaleCompare:!0,textExtraction:"simple",parsers:{},widgets:[],widgetZebra:{css:["even","odd"]},headers:{},widthFixed:!1,cancelSelection:!0,sortList:[],headerList:[],dateFormat:"us",decimal:"/.|,/g",onRenderHeader:null,selectorHeaders:"thead th",debug:!1},this.benchmark=benchmark,this.construct=function(a){return this.each(function(){if(this.tHead&&this.tBodies){var b,c,d,e;this.config={},e=$.extend(this.config,$.tablesorter.defaults,a),b=$(this),$.data(this,"tablesorter",e),c=buildHeaders(this),this.config.parsers=buildParserCache(this,c),d=buildCache(this);var f=[e.cssDesc,e.cssAsc];fixColumnWidth(this),c.click(function(a){var g=b[0].tBodies[0]&&b[0].tBodies[0].rows.length||0;if(!this.sortDisabled&&g>0){b.trigger("sortStart");var h=($(this),this.column);if(this.order=this.count++%2,this.lockedOrder&&(this.order=this.lockedOrder),a[e.sortMultiSortKey])if(isValueInArray(h,e.sortList))for(var i=0;i<e.sortList.length;i++){var j=e.sortList[i],k=e.headerList[j[0]];j[0]==h&&(k.count=j[1],k.count++,j[1]=k.count%2)}else e.sortList.push([h,this.order]);else{if(e.sortList=[],null!=e.sortForce)for(var l=e.sortForce,i=0;i<l.length;i++)l[i][0]!=h&&e.sortList.push(l[i]);e.sortList.push([h,this.order])}return setTimeout(function(){setHeadersCss(b[0],c,e.sortList,f),appendToTable(b[0],multisort(b[0],e.sortList,d))},1),!1}}).mousedown(function(){return e.cancelSelection?(this.onselectstart=function(){return!1},!1):void 0}),b.bind("update",function(){var a=this;setTimeout(function(){a.config.parsers=buildParserCache(a,c),d=buildCache(a)},1)}).bind("updateCell",function(a,b){var c=this.config,e=[b.parentNode.rowIndex-1,b.cellIndex];d.normalized[e[0]][e[1]]=c.parsers[e[1]].format(getElementText(c,b),b)}).bind("sorton",function(a,b){$(this).trigger("sortStart"),e.sortList=b;var g=e.sortList;updateHeaderSortCount(this,g),setHeadersCss(this,c,g,f),appendToTable(this,multisort(this,g,d))}).bind("appendCache",function(){appendToTable(this,d)}).bind("applyWidgetId",function(a,b){getWidgetById(b).format(this)}).bind("applyWidgets",function(){applyWidget(this)}),$.metadata&&$(this).metadata()&&$(this).metadata().sortlist&&(e.sortList=$(this).metadata().sortlist),e.sortList.length>0&&b.trigger("sorton",[e.sortList]),applyWidget(this)}})},this.addParser=function(a){for(var b=parsers.length,c=!0,d=0;b>d;d++)parsers[d].id.toLowerCase()==a.id.toLowerCase()&&(c=!1);c&&parsers.push(a)},this.addWidget=function(a){widgets.push(a)},this.formatFloat=function(a){var b=parseFloat(a);return isNaN(b)?0:b},this.formatInt=function(a){var b=parseInt(a);return isNaN(b)?0:b},this.isDigit=function(a){return/^[-+]?\d*$/.test($.trim(a.replace(/[,.']/g,"")))},this.clearTableBody=function(a){function b(){for(;this.firstChild;)this.removeChild(this.firstChild)}$.browser.msie?b.apply(a.tBodies[0]):a.tBodies[0].innerHTML=""}}}),$.fn.extend({tablesorter:$.tablesorter.construct});var ts=$.tablesorter;ts.addParser({id:"text",is:function(){return!0},format:function(a){return $.trim(a.toLocaleLowerCase())},type:"text"}),ts.addParser({id:"digit",is:function(a,b){var c=b.config;return $.tablesorter.isDigit(a,c)},format:function(a){return $.tablesorter.formatFloat(a)},type:"numeric"}),ts.addParser({id:"currency",is:function(a){return/^[£$€?.]/.test(a)},format:function(a){return $.tablesorter.formatFloat(a.replace(new RegExp(/[£$€]/g),""))},type:"numeric"}),ts.addParser({id:"ipAddress",is:function(a){return/^\d{2,3}[\.]\d{2,3}[\.]\d{2,3}[\.]\d{2,3}$/.test(a)},format:function(a){for(var b=a.split("."),c="",d=b.length,e=0;d>e;e++){var f=b[e];c+=2==f.length?"0"+f:f}return $.tablesorter.formatFloat(c)},type:"numeric"}),ts.addParser({id:"url",is:function(a){return/^(https?|ftp|file):\/\/$/.test(a)},format:function(a){return jQuery.trim(a.replace(new RegExp(/(https?|ftp|file):\/\//),""))},type:"text"}),ts.addParser({id:"isoDate",is:function(a){return/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(a)},format:function(a){return $.tablesorter.formatFloat(""!=a?new Date(a.replace(new RegExp(/-/g),"/")).getTime():"0")},type:"numeric"}),ts.addParser({id:"percent",is:function(a){return/\%$/.test($.trim(a))},format:function(a){return $.tablesorter.formatFloat(a.replace(new RegExp(/%/g),""))},type:"numeric"}),ts.addParser({id:"usLongDate",is:function(a){return a.match(new RegExp(/^[A-Za-z]{3,10}\.? [0-9]{1,2}, ([0-9]{4}|'?[0-9]{2}) (([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(AM|PM)))$/))},format:function(a){return $.tablesorter.formatFloat(new Date(a).getTime())},type:"numeric"}),ts.addParser({id:"shortDate",is:function(a){return/\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}/.test(a)},format:function(a,b){var c=b.config;return a=a.replace(/\-/g,"/"),"us"==c.dateFormat?a=a.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$1/$2"):"uk"==c.dateFormat?a=a.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$2/$1"):("dd/mm/yy"==c.dateFormat||"dd-mm-yy"==c.dateFormat)&&(a=a.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2})/,"$1/$2/$3")),$.tablesorter.formatFloat(new Date(a).getTime())},type:"numeric"}),ts.addParser({id:"time",is:function(a){return/^(([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(am|pm)))$/.test(a)},format:function(a){return $.tablesorter.formatFloat(new Date("2000/01/01 "+a).getTime())},type:"numeric"}),ts.addParser({id:"metadata",is:function(){return!1},format:function(a,b,c){var d=b.config,e=d.parserMetadataName?d.parserMetadataName:"sortValue";return $(c).metadata()[e]},type:"numeric"}),ts.addWidget({id:"zebra",format:function(a){if(a.config.debug)var b=new Date;var c,d,e=-1;$("tr:visible",a.tBodies[0]).each(function(){c=$(this),c.hasClass(a.config.cssChildRow)||e++,d=e%2==0,c.removeClass(a.config.widgetZebra.css[d?0:1]).addClass(a.config.widgetZebra.css[d?1:0])}),a.config.debug&&$.tablesorter.benchmark("Applying Zebra widget",b)}})}(jQuery);